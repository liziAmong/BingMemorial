<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>🐰ASMR 음성 가챠</title>
  <style>
    body {
      font-family: 'Nunito', sans-serif;
      margin: 20px auto;
      max-width: 700px;
      padding: 0 10px;
      color: #333;
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
      transition: background 0.8s ease;
    }
    /* 슬라이드별 배경색 */
body.bg1 {
  background: linear-gradient(135deg, #2d2d44, #57618c);
}
body.bg2 {
  background: linear-gradient(135deg, #5c3a3a, #a0807a);
}
body.bg3 {
  background: linear-gradient(135deg, #fafafa, #f0f0f0);
}
body.bg4 {
  background: linear-gradient(135deg, #c8c8c8, #e1e1e1);
}
body.bg5 {
  background: linear-gradient(135deg, #fff8dc, #fffdf0);
}
body.bg6 {
  background: linear-gradient(135deg, #f3e2d2, #f8f0e8);
}
body.bg7 {
  background: linear-gradient(135deg, #bcd4e6, #d6e6f8);
}
body.bg8 {
  background: linear-gradient(135deg, #4b607c, #ffddee);
}
body.bg9 {
  background: linear-gradient(135deg, #d8d8d8, #efefef);
}
body.bg10 {
  background: linear-gradient(135deg, #cd8c70, #e0b9a0);
}
body.bg11 {
  background: linear-gradient(135deg, #e0d5b9, #f1ead7);
}
body.bg12 {
  background: linear-gradient(135deg, #fff0f5, #ffe7f0);
}
body.bg13 {
  background: linear-gradient(135deg, #4c5c78, #7a8ba7);
}
body.bg14 {
  background: linear-gradient(135deg, #d0f0ff, #e0f8ff);
}
body.bg15 {
  background: linear-gradient(135deg, #ffd6dc, #ffe7eb);
}
body.bg16 {
  background: linear-gradient(135deg, #e6f2fa, #f2fbff);
}
body.bg17 {
  background: linear-gradient(135deg, #cda69c, #e3c4b9);
}
body.bg18 {
  background: linear-gradient(135deg, #a8d0d6, #cae3e7);
}
body.bg19 {
  background: linear-gradient(135deg, #3a3a5c, #63648a);
}
body.bg20 {
  background: linear-gradient(135deg, #fdfaf7, #fffdfb);
}

    /* 가챠 희귀도별 배경 */
    body.normal-bg {
      background: linear-gradient(to bottom, #ffe6f0, #e0f7ff);
    }
    body.rare-bg {
      background: linear-gradient(to bottom, #a1c4fd, #c2e9fb);
    }
    body.special-bg {
      background: linear-gradient(to bottom, #ff9a9e, #fecfef);
    }

    /* 이하 기존 스타일 유지 */
    .slider-container {
      width: 100%;
      text-align: center;
      margin-top: 20px;
    }
    #main-image {
      width: 100%;
      height: auto;
      object-fit: contain;
      display: block;
      margin: 0 auto 15px auto;
      border-radius: 20px;
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
      cursor: pointer;
    }
    #image-title {
      margin-top: 10px;
      font-size: 1.2rem;
      font-weight: 700;
      color: #d81b60;
      text-align: center;
      user-select: none;
      min-height: 28px;
    }
    #easter-egg-click-counter {
      display: none !important;
    }
    .controls {
      margin-top: 15px;
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      align-items: center;
      gap: 15px;
    }
    button {
      background-color: #ffb6c1;
      color: white;
      border: none;
      border-radius: 12px;
      padding: 10px 16px;
      font-size: 15px;
      cursor: pointer;
      transition: background 0.3s ease, transform 0.2s ease;
      font-weight: bold;
      min-width: 100px;
    }
    button:hover:not(:disabled) {
      background-color: #ff69b4;
      transform: scale(1.05);
    }
    button:disabled {
      background-color: #ccc;
      cursor: not-allowed;
      opacity: 0.7;
    }
    .gacha-box {
      margin: 20px auto;
      min-height: 60px;
      font-size: 1.8rem;
      font-weight: bold;
      padding: 12px 20px;
      border-radius: 18px;
      transition: all 0.4s ease;
    }
    .rarity-normal {
      background-color: #f0f0f0;
      color: #555;
    }
    .rarity-rare {
      background-color: #87cefa;
      color: white;
      animation: rarity-flash 1s ease-in-out;
      box-shadow: 0 0 15px 3px #64b5f6;
    }
    .rarity-special {
      background-color: #ff69b4;
      color: white;
      animation: rarity-flash 1s ease-in-out;
      box-shadow: 0 0 20px 4px #ff4081;
    }
    @keyframes rarity-flash {
      0% { transform: scale(1); opacity: 0.5; }
      50% { transform: scale(1.2); opacity: 1; }
      100% { transform: scale(1); }
    }
    .home-link {
      margin: 30px auto;
      text-align: center;
    }
    .home-link button {
      background-color: #ffb6c1;
      padding: 10px 20px;
      font-size: 1rem;
      border-radius: 12px;
    }
    #easter-egg-player {
      display: none;
      margin-top: 15px;
      padding: 10px;
      border: 2px dashed #ff8be7;
      background: #fff0fb;
      border-radius: 12px;
      animation: sparkle 1s ease-out infinite alternate;
      text-align: center;
      user-select: none;
    }
    #easter-egg-player button {
      background-color: #ff85c1;
      border-radius: 12px;
      border: none;
      color: white;
      padding: 8px 14px;
      margin: 5px;
      font-weight: bold;
      cursor: pointer;
      transition: background 0.3s ease;
    }
    #easter-egg-player button:hover {
      background-color: #ff3a85;
    }
    @keyframes sparkle {
      0% { box-shadow: 0 0 5px #ffb3ec; }
      100% { box-shadow: 0 0 20px #ff6fd8; }
    }
    /* 미니 플레이어 관련 스타일 */
    #mini-player {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      width: 95%;
      max-width: 520px;
      background: rgba(255, 255, 255, 0.8);
      backdrop-filter: blur(8px);
      border-radius: 20px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
      z-index: 1000;
      padding: 12px 16px;
      display: none;
      flex-direction: column;
      gap: 6px;
    }
    .mini-player-content {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
    }
    .mini-player-controls {
      display: flex;
      gap: 10px;
    }
    #mini-player-title {
      flex: 2;
      font-weight: 900;
      font-size: 0.8rem;
      color: #d81b60;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    #progress-bar {
      flex: 2;
      -webkit-appearance: none;
      height: 5px;
      background: #ff69b4;
      border-radius: 3px;
      outline: none;
      cursor: pointer;
    }
    #volume-bar {
      width: 100%;
      -webkit-appearance: none;
      height: 5px;
      background: #aaa;
      border-radius: 3px;
      outline: none;
      cursor: pointer;
    }
    #progress-bar::-webkit-slider-thumb,
    #volume-bar::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 10px;
      height: 10px;
      background: white;
      border-radius: 50%;
      border: 1px solid #ccc;
      cursor: pointer;
    }
    @media (max-width: 768px) {
      body {
        padding: 0 15px;
        font-size: 15px;
      }
      .controls {
        flex-direction: column;
        gap: 10px;
      }
      #mini-player {
        padding: 10px;
      }
      .mini-player-content {
        flex-direction: column;
        align-items: stretch;
      }
      .mini-player-controls {
        justify-content: flex-end;
      }
    }
  </style>
</head>
<body class="bg1" oncontextmenu="return false">
  <div class="slider-container">
    <img id="main-image" src="images/image1.jpg" alt="슬라이드 이미지" />
    <div id="image-title">들어오세요 하유</div>
    <div id="easter-egg-click-counter">0 / 13</div>
    <div id="gacha-box" class="gacha-box rarity-normal">-</div>
    <div class="controls">
      <button id="sound-btn">🎲 가챠 돌리기</button>
      <button id="prev-btn">◀ 이전</button>
      <div id="counter">1 / 20</div>
      <button id="next-btn">다음 ▶</button>
    </div>
  </div>

  <div class="home-link">
    <a href="index.html"><button>🏠 메인으로 돌아가기</button></a>
  </div>

  <!-- 이스터에그 음성 플레이어 -->
  <div id="easter-egg-player">
    <p>🌟 이스터에그 발견! 원하는 음성을 들어보세요:</p>
    <button data-type="normal">노말 음성</button>
    <button data-type="rare">레어 음성</button>
    <button data-type="special">스페셜 음성</button>
  </div>

  <div id="mini-player">
    <div class="mini-player-content">
      <div id="mini-player-title">🔊 재생 중...</div>
      <input type="range" id="progress-bar" value="0" step="1" min="0" max="100" />
      <div class="mini-player-controls">
        <button id="pause-btn">⏸️</button>
        <button id="close-btn">❌</button>
      </div>
    </div>
    <input type="range" id="volume-bar" min="0" max="1" step="0.01" value="1" />
  </div>

  <script>
    // 우클릭, 복사, 붙여넣기, 개발자도구 단축키 방지
    document.addEventListener('contextmenu', e => e.preventDefault());
    document.addEventListener('copy', e => e.preventDefault());
    document.addEventListener('paste', e => e.preventDefault());
    document.addEventListener('keydown', function (e) {
      if (
        e.key === 'F12' ||
        (e.ctrlKey && e.shiftKey && ['I', 'J', 'C'].includes(e.key.toUpperCase())) ||
        (e.ctrlKey && e.key.toUpperCase() === 'U')
      ) {
        e.preventDefault();
      }
    });

    const totalItems = 20;
    let currentIndex = 0;
    const imageElement = document.getElementById("main-image");
    const gachaBox = document.getElementById("gacha-box");
    const soundButton = document.getElementById("sound-btn");
    const counter = document.getElementById("counter");
    const miniPlayer = document.getElementById("mini-player");
    const progressBar = document.getElementById("progress-bar");
    const volumeBar = document.getElementById("volume-bar");
    const pauseBtn = document.getElementById("pause-btn");
    const closeBtn = document.getElementById("close-btn");
    const miniTitle = document.getElementById("mini-player-title");

    const eggClickCounter = document.getElementById("easter-egg-click-counter");
    const eggPlayer = document.getElementById("easter-egg-player");

    const images = Array.from({ length: totalItems }, (_, i) => `images/image${i + 1}.jpg`);
    const sounds = Array.from({ length: totalItems }, (_, i) => ({
      normal: `sounds/sound${i + 1}_1.mp3`,
      rare: `sounds/sound${i + 1}_2.mp3`,
      special: `sounds/sound${i + 1}_special.mp3`,
    }));

    const titles = [
      "들어오세요 하유",
      "사탕물어요 하유",
      "어제어땠어 하유",
      "오피스바닥 하유",
      "오피스선배 하유",
      "미시일루왓 하유",
      "커피데이트 하유",
      "노말타입임 하유",
      "남친셔츠당 하유",
      "송편드세요 하유",
      "라디오에요 하유",
      "바니잠옷임 하유",
      "고스트짜잔 하유",
      "손꼭잡은낮 하유",
      "손꼭잡은밤 하유",
      "무릎강조중 하유",
      "산타입니다 하유",
      "푸른뱀이당 하유",
      "밤도시볼턱 하유",
      "사인귀파줘 하유"
    ];

    const voiceNames = [
      ["보쌈하는중", "눈감으면이런느낌", "이정도로붙으면곤란"],
      ["발렌타인잘보내", "알파벳시동", "알파벳"],
      ["세팅중인", "안찐득찐득", "찾았다"],
      ["그런취향", "선택지", "카운트다운"],
      ["잘거면지금", "허벅지요", "내가이럴줄꼬르륵"],
      ["그냥야로끝나면", "날씨가덥다", "여보야자기야"],
      ["원하는호칭", "물좀마실게", "오쁘으어오빠"],
      ["프로바니걸", "야발좋아해", "3시간하면저죽어욧"],
      ["이러면안들리지바보", "호해봐호", "수고했어오늘도"],
      ["다오셨을거니까", "심장박동", "카운트다운"],
      ["깜빡미성안녕", "두근두근", "해달라는거다해줘"],
      ["그루밍주인님", "바보", "바보멍청이바보"],
      ["왕년에", "치즈를안잡아먹지", "혀놀림"],
      ["저기터져나가는세상", "이거는알아서상상", "펀치숨소리"],
      ["오빠는어캐부를건데", "자기야자기야자기야", "사랑해사랑해사랑해"],
      ["내눈보고있는거맞지", "꼬르륵왜잡히냐구", "배방구스페셜"],
      ["깔아뭉겠어", "저ㅆㅆ가", "뽀뽀뽀"],
      ["정신이들어", "나는뱀이고", "레로레로"],
      ["같이달보러", "너무쎄게아퍼", "ㅗㅜㅑ"],
      ["에취에으흐으응", "여성호르몬과다", "두근뽀뽀후우"],
    ];

    let audioPlayer = null;
    let progressInterval = null;

    // 이스터에그 해금 여부 세션스토리지에서 불러오기
    let easterEggUnlocked = sessionStorage.getItem('easterEggUnlocked') === 'true';
    let eggClickCount = parseInt(sessionStorage.getItem('eggClickCount'), 10) || 0;

    // 슬라이드별 배경 클래스 배열
    const normalBgClasses = [
      "bg1","bg2","bg3","bg4","bg5","bg6","bg7","bg8","bg9","bg10",
      "bg11","bg12","bg13","bg14","bg15","bg16","bg17","bg18","bg19","bg20"
    ];

    function updateDisplay() {
      imageElement.src = images[currentIndex];

      // 가챠 배경이 아닐 때만 슬라이드 배경 적용
      if (!document.body.classList.contains("rare-bg") && !document.body.classList.contains("special-bg")) {
        document.body.className = "";
        document.body.classList.add(normalBgClasses[currentIndex]);
      }

      counter.textContent = `${currentIndex + 1} / ${totalItems}`;
      gachaBox.textContent = "-";
      gachaBox.className = "gacha-box rarity-normal";
      document.getElementById("image-title").textContent = titles[currentIndex];
      soundButton.disabled = false;
      hideEggCounterIfNeeded();

      eggPlayer.style.display = easterEggUnlocked ? "block" : "none";

      if (currentIndex === 19) {
        eggClickCounter.style.display = "block";
        eggClickCounter.textContent = `${eggClickCount} / 13`;
      } else {
        eggClickCounter.style.display = "none";
        eggClickCount = 0;
        sessionStorage.setItem('eggClickCount', eggClickCount);
      }

      if (audioPlayer) {
        audioPlayer.pause();
        audioPlayer = null;
      }
      miniPlayer.style.display = "none";
    }

    // 다음 슬라이드
    function nextSlide() {
      if (currentIndex < totalItems - 1) {
        currentIndex++;
        updateDisplay();
      }
    }

    // 이전 슬라이드
    function prevSlide() {
      if (currentIndex > 0) {
        currentIndex--;
        updateDisplay();
      }
    }

    // 가챠 버튼 클릭
    soundButton.addEventListener("click", () => {
      soundButton.disabled = true;
      gachaBox.textContent = "🎲 돌리는중...";
      gachaBox.className = "gacha-box rarity-normal";

      // 랜덤 확률 (간단 예: 10% rare, 3% special)
      const randomNum = Math.random();
      let rarity = "normal";
      if (randomNum < 0.03) {
        rarity = "special";
      } else if (randomNum < 0.13) {
        rarity = "rare";
      }

      // 오디오 소스 선택
      let audioSrc;
      let label;
      if (rarity === "normal") {
        audioSrc = sounds[currentIndex].normal;
        label = voiceNames[currentIndex][0];
      } else if (rarity === "rare") {
        audioSrc = sounds[currentIndex].rare;
        label = voiceNames[currentIndex][1];
      } else {
        audioSrc = sounds[currentIndex].special;
        label = voiceNames[currentIndex][2];
      }

      // 0.7초 후 결과 표시 및 재생
      setTimeout(() => {
        gachaBox.textContent = rarity === "normal" ? "🎵 노말" : rarity === "rare" ? "🌟 레어 등장!" : "💖 스페셜 획득!";
        gachaBox.className = `gacha-box rarity-${rarity}`;
        document.body.className = rarity + "-bg";

        playAudio(audioSrc, label);
        soundButton.disabled = false;
      }, 700);
    });

    // 오디오 재생 함수
    function playAudio(src, title) {
      if (audioPlayer) {
        audioPlayer.pause();
        audioPlayer = null;
      }

      audioPlayer = new Audio(src);
      audioPlayer.volume = volumeBar.value;
      audioPlayer.play();

      miniTitle.textContent = title;
      miniPlayer.style.display = "flex";

      // 프로그래스 바 업데이트
      progressBar.value = 0;
      progressBar.max = 100;

      if (progressInterval) clearInterval(progressInterval);

      progressInterval = setInterval(() => {
        if (audioPlayer && audioPlayer.duration) {
          progressBar.value = (audioPlayer.currentTime / audioPlayer.duration) * 100;
        }
      }, 250);

      audioPlayer.onended = () => {
        miniPlayer.style.display = "none";
        clearInterval(progressInterval);
      };
    }

    // 프로그래스 바 수동 이동
    progressBar.addEventListener("input", () => {
      if (audioPlayer && audioPlayer.duration) {
        audioPlayer.currentTime = (progressBar.value / 100) * audioPlayer.duration;
      }
    });

    // 볼륨 조절
    volumeBar.addEventListener("input", () => {
      if (audioPlayer) {
        audioPlayer.volume = volumeBar.value;
      }
    });

    // 일시정지 버튼
    pauseBtn.addEventListener("click", () => {
      if (!audioPlayer) return;
      if (audioPlayer.paused) {
        audioPlayer.play();
        pauseBtn.textContent = "⏸️";
      } else {
        audioPlayer.pause();
        pauseBtn.textContent = "▶️";
      }
    });

    // 플레이어 닫기
    closeBtn.addEventListener("click", () => {
      if (audioPlayer) {
        audioPlayer.pause();
        audioPlayer = null;
      }
      miniPlayer.style.display = "none";
    });

    // 이미지 클릭(이스터에그 카운트)
    imageElement.addEventListener("click", () => {
      if (currentIndex === 19 && !easterEggUnlocked) {
        eggClickCount++;
        if (eggClickCount >= 13) {
          easterEggUnlocked = true;
          sessionStorage.setItem('easterEggUnlocked', 'true');
          eggPlayer.style.display = "block";
          eggClickCounter.style.display = "none";
          alert("🌟 이스터에그가 해금되었습니다!");
        }
        sessionStorage.setItem('eggClickCount', eggClickCount);
        eggClickCounter.textContent = `${eggClickCount} / 13`;
      }
    });

    // 이스터에그 음성 플레이어 버튼
    eggPlayer.querySelectorAll("button").forEach(button => {
      button.addEventListener("click", () => {
        const type = button.dataset.type;
        let audioSrc;
        let label;

        if (type === "normal") {
          audioSrc = sounds[19].normal;
          label = voiceNames[19][0];
        } else if (type === "rare") {
          audioSrc = sounds[19].rare;
          label = voiceNames[19][1];
        } else {
          audioSrc = sounds[19].special;
          label = voiceNames[19][2];
        }

        playAudio(audioSrc, label);
      });
    });

    // 이전, 다음 버튼 이벤트
    document.getElementById("next-btn").addEventListener("click", () => {
      if (currentIndex < totalItems - 1) {
        currentIndex++;
        updateDisplay();
      }
    });

    document.getElementById("prev-btn").addEventListener("click", () => {
      if (currentIndex > 0) {
        currentIndex--;
        updateDisplay();
      }
    });

    // 초기 화면 업데이트
    updateDisplay();

    // 이스터에그 카운터 숨기기/보이기 함수
    function hideEggCounterIfNeeded() {
      if (currentIndex === 19 && !easterEggUnlocked) {
        eggClickCounter.style.display = "block";
      } else {
        eggClickCounter.style.display = "none";
      }
    }
  </script>
</body>
</html>
