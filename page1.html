<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>🐰ASMR 음성 가챠</title>
  <style>
    body {
      font-family: 'Nunito', sans-serif;
      margin: 20px auto;
      max-width: 700px;
      padding: 0 10px;
      color: #333;
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
      transition: background 0.8s ease;
      background: linear-gradient(to bottom, #ffe6f0, #e0f7ff);
    }
    body.normal-bg {
      background: linear-gradient(to bottom, #ffe6f0, #e0f7ff);
    }
    body.rare-bg {
      background: linear-gradient(to bottom, #a1c4fd, #c2e9fb);
    }
    body.special-bg {
      background: linear-gradient(to bottom, #ff9a9e, #fecfef);
    }
    .slider-container {
      width: 100%;
      text-align: center;
      margin-top: 20px;
    }
    #main-image {
      width: 100%;
      height: auto;
      object-fit: contain;
      display: block;
      margin: 0 auto 15px auto;
      border-radius: 20px;
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
      cursor: pointer;
    }
    #image-title {
      margin-top: 10px;
      font-size: 1.2rem;
      font-weight: 700;
      color: #d81b60;
      text-align: center;
      user-select: none;
      min-height: 28px;
    }
    #easter-egg-click-counter {
    display: none !important;
    }
    .controls {
      margin-top: 15px;
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      align-items: center;
      gap: 15px;
    }
    button {
      background-color: #ffb6c1;
      color: white;
      border: none;
      border-radius: 12px;
      padding: 10px 16px;
      font-size: 15px;
      cursor: pointer;
      transition: background 0.3s ease, transform 0.2s ease;
      font-weight: bold;
      min-width: 100px;
    }
    button:hover:not(:disabled) {
      background-color: #ff69b4;
      transform: scale(1.05);
    }
    button:disabled {
      background-color: #ccc;
      cursor: not-allowed;
      opacity: 0.7;
    }
    .gacha-box {
      margin: 20px auto;
      min-height: 60px;
      font-size: 1.8rem;
      font-weight: bold;
      padding: 12px 20px;
      border-radius: 18px;
      transition: all 0.4s ease;
    }
    .rarity-normal {
      background-color: #f0f0f0;
      color: #555;
    }
    .rarity-rare {
      background-color: #87cefa;
      color: white;
      animation: rarity-flash 1s ease-in-out;
      box-shadow: 0 0 15px 3px #64b5f6;
    }
    .rarity-special {
      background-color: #ff69b4;
      color: white;
      animation: rarity-flash 1s ease-in-out;
      box-shadow: 0 0 20px 4px #ff4081;
    }
    @keyframes rarity-flash {
      0% { transform: scale(1); opacity: 0.5; }
      50% { transform: scale(1.2); opacity: 1; }
      100% { transform: scale(1); }
    }
    .home-link {
      margin: 30px auto;
      text-align: center;
    }
    .home-link button {
      background-color: #ffb6c1;
      padding: 10px 20px;
      font-size: 1rem;
      border-radius: 12px;
    }
    #easter-egg-player {
      display: none;
      margin-top: 15px;
      padding: 10px;
      border: 2px dashed #ff8be7;
      background: #fff0fb;
      border-radius: 12px;
      animation: sparkle 1s ease-out infinite alternate;
      text-align: center;
      user-select: none;
    }
    #easter-egg-player button {
      background-color: #ff85c1;
      border-radius: 12px;
      border: none;
      color: white;
      padding: 8px 14px;
      margin: 5px;
      font-weight: bold;
      cursor: pointer;
      transition: background 0.3s ease;
    }
    #easter-egg-player button:hover {
      background-color: #ff3a85;
    }
    @keyframes sparkle {
      0% { box-shadow: 0 0 5px #ffb3ec; }
      100% { box-shadow: 0 0 20px #ff6fd8; }
    }
    /* 미니 플레이어 관련 스타일 */
    #mini-player {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      width: 95%;
      max-width: 520px;
      background: rgba(255, 255, 255, 0.8);
      backdrop-filter: blur(8px);
      border-radius: 20px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
      z-index: 1000;
      padding: 12px 16px;
      display: none;
      flex-direction: column;
      gap: 6px;
    }
    .mini-player-content {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
    }
    .mini-player-controls {
      display: flex;
      gap: 10px;
    }
    #mini-player-title {
      flex: 2;
      font-weight: 900;
      font-size: 0.8rem;
      color: #d81b60;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    #progress-bar {
      flex: 2;
      -webkit-appearance: none;
      height: 5px;
      background: #ff69b4;
      border-radius: 3px;
      outline: none;
      cursor: pointer;
    }
    #volume-bar {
      width: 100%;
      -webkit-appearance: none;
      height: 5px;
      background: #aaa;
      border-radius: 3px;
      outline: none;
      cursor: pointer;
    }
    #progress-bar::-webkit-slider-thumb,
    #volume-bar::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 10px;
      height: 10px;
      background: white;
      border-radius: 50%;
      border: 1px solid #ccc;
      cursor: pointer;
    }
    @media (max-width: 768px) {
      body {
        padding: 0 15px;
        font-size: 15px;
      }
      .controls {
        flex-direction: column;
        gap: 10px;
      }
      #mini-player {
        padding: 10px;
      }
      .mini-player-content {
        flex-direction: column;
        align-items: stretch;
      }
      .mini-player-controls {
        justify-content: flex-end;
      }
    }
  </style>
</head>
<body class="normal-bg" oncontextmenu="return false">
  <div class="slider-container">
    <img id="main-image" src="images/image1.jpg" alt="슬라이드 이미지" />
    <div id="image-title">들어오세요 하유</div>
    <div id="easter-egg-click-counter">0 / 13</div>
    <div id="gacha-box" class="gacha-box rarity-normal">-</div>
    <div class="controls">
      <button id="sound-btn">🎲 가챠 돌리기</button>
      <button id="prev-btn">◀ 이전</button>
      <div id="counter">1 / 20</div>
      <button id="next-btn">다음 ▶</button>
    </div>
  </div>

  <div class="home-link">
    <a href="index.html"><button>🏠 메인으로 돌아가기</button></a>
  </div>

  <!-- 이스터에그 음성 플레이어 -->
  <div id="easter-egg-player">
    <p>🌟 이스터에그 발견! 원하는 음성을 들어보세요:</p>
    <button data-type="normal">노말 음성</button>
    <button data-type="rare">레어 음성</button>
    <button data-type="special">스페셜 음성</button>
  </div>

  <div id="mini-player">
    <div class="mini-player-content">
      <div id="mini-player-title">🔊 재생 중...</div>
      <input type="range" id="progress-bar" value="0" step="1" min="0" max="100" />
      <div class="mini-player-controls">
        <button id="pause-btn">⏸️</button>
        <button id="close-btn">❌</button>
      </div>
    </div>
    <input type="range" id="volume-bar" min="0" max="1" step="0.01" value="1" />
  </div>

  <script>
    // 우클릭, 복사, 붙여넣기, 개발자도구 단축키 방지
    document.addEventListener('contextmenu', e => e.preventDefault());
    document.addEventListener('copy', e => e.preventDefault());
    document.addEventListener('paste', e => e.preventDefault());
    document.addEventListener('keydown', function (e) {
      if (
        e.key === 'F12' ||
        (e.ctrlKey && e.shiftKey && ['I', 'J', 'C'].includes(e.key.toUpperCase())) ||
        (e.ctrlKey && e.key.toUpperCase() === 'U')
      ) {
        e.preventDefault();
      }
    });

    const totalItems = 20;
    let currentIndex = 0;
    const imageElement = document.getElementById("main-image");
    const gachaBox = document.getElementById("gacha-box");
    const soundButton = document.getElementById("sound-btn");
    const counter = document.getElementById("counter");
    const miniPlayer = document.getElementById("mini-player");
    const progressBar = document.getElementById("progress-bar");
    const volumeBar = document.getElementById("volume-bar");
    const pauseBtn = document.getElementById("pause-btn");
    const closeBtn = document.getElementById("close-btn");
    const miniTitle = document.getElementById("mini-player-title");

    const eggClickCounter = document.getElementById("easter-egg-click-counter");
    const eggPlayer = document.getElementById("easter-egg-player");

    const images = Array.from({ length: totalItems }, (_, i) => `images/image${i + 1}.jpg`);
    const sounds = Array.from({ length: totalItems }, (_, i) => ({
      normal: `sounds/sound${i + 1}_1.mp3`,
      rare: `sounds/sound${i + 1}_2.mp3`,
      special: `sounds/sound${i + 1}_special.mp3`,
    }));

    const titles = [
      "들어오세요 하유",
      "사탕물어요 하유",
      "어제어땠어 하유",
      "오피스바닥 하유",
      "오피스선배 하유",
      "미시일루왓 하유",
      "커피데이트 하유",
      "노말타입임 하유",
      "남친셔츠당 하유",
      "송편드세요 하유",
      "라디오에요 하유",
      "바니잠옷임 하유",
      "고스트짜잔 하유",
      "손꼭잡은낮 하유",
      "손꼭잡은밤 하유",
      "무릎강조중 하유",
      "산타입니다 하유",
      "푸른뱀이당 하유",
      "밤도시볼턱 하유",
      "사인귀파줘 하유"
    ];

    const voiceNames = [
      ["보쌈하는중", "눈감으면이런느낌", "이정도로붙으면곤란"],
      ["발렌타인잘보내", "알파벳시동", "알파벳"],
      ["세팅중인", "안찐득찐득", "찾았다"],
      ["그런취향", "선택지", "카운트다운"],
      ["잘거면지금", "허벅지요", "내가이럴줄꼬르륵"],
      ["그냥야로끝나면", "날씨가덥다", "여보야자기야"],
      ["원하는호칭", "물좀마실게", "오쁘으어오빠"],
      ["프로바니걸", "야발좋아해", "3시간하면저죽어욧"],
      ["이러면안들리지바보", "호해봐호", "수고했어오늘도"],
      ["다오셨을거니까", "심장박동", "카운트다운"],
      ["깜빡미성안녕", "두근두근", "해달라는거다해줘"],
      ["그루밍주인님", "바보", "바보멍청이바보"],
      ["왕년에", "치즈를안잡아먹지", "혀놀림"],
      ["저기터져나가는세상", "이거는알아서상상", "펀치숨소리"],
      ["오빠는어캐부를건데", "자기야자기야자기야", "사랑해사랑해사랑해"],
      ["내눈보고있는거맞지", "꼬르륵왜잡히냐구", "배방구스페셜"],
      ["깔아뭉겠어", "저ㅆㅆ가", "뽀뽀뽀"],
      ["정신이들어", "나는뱀이고", "레로레로"],
      ["같이달보러", "너무쎄게아퍼", "ㅗㅜㅑ"],
      ["에취에으흐으응", "여성호르몬과다", "두근뽀뽀후우"],
    ];

    let audioPlayer = null;
    let progressInterval = null;

    // 이스터에그 해금 여부 세션스토리지에서 불러오기
    let easterEggUnlocked = sessionStorage.getItem('easterEggUnlocked') === 'true';
    let eggClickCount = 0;

    function updateDisplay() {
      imageElement.src = images[currentIndex];
// 이미지별 배경색 설정
const bgColors = [
  "#2d2d44",    // 1. 밤의 어두운색 → 연한 남색 계열
  "#5c3a3a",    // 2. 붉은 어두운색 → 부드러운 브라운레드
  "#fafafa",    // 3. 아침의 하양색 → 거의 흰색
  "#c8c8c8",    // 4. 오피스 바닥 그림자 → 중간 회색
  "#fff8dc",    // 5. 밝은 전등색 → 크림 톤
  "#f3e2d2",    // 6. 아늑한 방색 → 베이지핑크
  "#bcd4e6",    // 7. 도시 외부 → 연한 스카이블루
  "linear-gradient(135deg, #4b607c, #ffddee)",  // 8. 군청핑크 → 연한 버전
  "#d8d8d8",    // 9. 셔츠 느낌 회색 → 밝은 회색
  "#cd8c70",    // 10. 붉은 나무색 → 연한 브릭
  "#e0d5b9",    // 11. 라디오 느낌 → 밝은 빈티지
  "#fff0f5",    // 12. 바니잠옷 → 라이트 핑크
  "#4c5c78",    // 13. 밤하늘 → 연한 쪽빛
  "#d0f0ff",    // 14. 밝은 하늘 → 아기 하늘색
  "#ffd6dc",    // 15. 밤 축제 → 연한 살구핑크
  "#e6f2fa",    // 16. 별자리 → 연한 하늘배경
  "#cda69c",    // 17. 벽난로 → 따뜻한 연갈색
  "#a8d0d6",    // 18. 푸른 뱀 → 파스텔 민트
  "#3a3a5c",    // 19. 밤의 도시 → 연한 쿨네이비
  "#fdfaf7"     // 20. 코튼 → 연베이지
];


const bg = bgColors[currentIndex];
if (bg.startsWith("linear-gradient")) {
  document.body.style.background = bg;
} else {
  document.body.style.background = "";
  document.body.style.backgroundColor = bg;
}
      counter.textContent = `${currentIndex + 1} / ${totalItems}`;
      gachaBox.textContent = "-";
      gachaBox.className = "gacha-box rarity-normal";
      document.body.className = "normal-bg";
      document.getElementById("image-title").textContent = titles[currentIndex];
      soundButton.disabled = false;
      hideEggCounterIfNeeded();
      // 이스터에그 플레이어 노출 제어
      eggPlayer.style.display = easterEggUnlocked ? "block" : "none";
      // 클릭 카운터 초기화는 20번 슬라이드 아니면 숨기고 리셋
      if (currentIndex === 19) {
        eggClickCounter.style.display = "block";
        eggClickCounter.textContent = `${eggClickCount} / 13`;
      } else {
        eggClickCounter.style.display = "none";
        eggClickCount = 0;
        sessionStorage.setItem('eggClickCount', eggClickCount);
      }
      if (audioPlayer) {
        audioPlayer.pause();
        audioPlayer = null;
      }
      miniPlayer.style.display = "none";
    }

    function hideEggCounterIfNeeded() {
      if (currentIndex !== 19) {
        eggClickCounter.style.display = "none";
      }
    }

    function playGachaEffect() {
      const roll = Math.random();
      const soundSet = sounds[currentIndex];
      let rarity = "normal";
      let audioSrc = soundSet.normal;
      let label = voiceNames[currentIndex][0];

      if (roll < 0.5) {
        rarity = "normal";
        audioSrc = soundSet.normal;
        label = voiceNames[currentIndex][0];
      } else if (roll < 0.8) {
        rarity = "rare";
        audioSrc = soundSet.rare;
        label = voiceNames[currentIndex][1];
      } else {
        rarity = "special";
        audioSrc = soundSet.special;
        label = voiceNames[currentIndex][2];
      }

      soundButton.disabled = true;
      gachaBox.textContent = "🔄 로딩 중...";
      gachaBox.className = "gacha-box rolling";

      setTimeout(() => {
        gachaBox.textContent = rarity === "normal" ? "🎵 노말" : rarity === "rare" ? "🌟 레어 등장!" : "💖 스페셜 획득!";
        gachaBox.className = `gacha-box rarity-${rarity}`;
        document.body.className = rarity + "-bg";

        playAudio(audioSrc, label);
        soundButton.disabled = false;
      }, 700);
    }

    function playAudio(src,label) {
      if (audioPlayer) {
        audioPlayer.pause();
        audioPlayer = null;
      }
      audioPlayer = new Audio(src);
      audioPlayer.volume = volumeBar.value;
      audioPlayer.play();
      miniTitle.textContent = label;
      miniPlayer.style.display = "flex";
      progressBar.value = 0;
      progressBar.max = 100;

      if (progressInterval) clearInterval(progressInterval);
      progressInterval = setInterval(() => {
        if (audioPlayer.duration) {
          progressBar.value = (audioPlayer.currentTime / audioPlayer.duration) * 100;
        }
      }, 200);

      audioPlayer.onended = () => {
        miniPlayer.style.display = "none";
        if (progressInterval) clearInterval(progressInterval);
      };
    }

    // 이스터에그 음성 재생 함수
  function playEasterEggAudio(type) {
  if (!easterEggUnlocked) return;
  const audioSrc = sounds[currentIndex][type];
  if (!audioSrc) return;

  let label;
  if (type === 'normal') {
    label = voiceNames[currentIndex][0];
  } else if (type === 'rare') {
    label = voiceNames[currentIndex][1];
  } else if (type === 'special') {
    label = voiceNames[currentIndex][2];
  } else {
    label = "음성";
  }

  playAudio(audioSrc, label);
}

    // 이스터에그 클릭 카운터 업데이트 & 해금 체크
    function incrementEggClick() {
      if (currentIndex !== 19) return; // 20번 슬라이드에서만 카운트
      eggClickCount++;
      eggClickCounter.textContent = `${eggClickCount} / 13`;
      sessionStorage.setItem('eggClickCount', eggClickCount);
      if (eggClickCount >= 13 && !easterEggUnlocked) {
        easterEggUnlocked = true;
        sessionStorage.setItem('easterEggUnlocked', 'true');
        alert("🌟 이스터 에그가 해금되었습니다! 아래 플레이어에서 음성을 들어보세요.");
        eggPlayer.style.display = "block";
      }
    }

    // 이미지 클릭 시 이벤트
    imageElement.addEventListener('click', () => {
      incrementEggClick();
    });

    // 가챠 버튼 클릭 이벤트
    soundButton.addEventListener('click', () => {
      playGachaEffect();
    });

    // 이전 버튼 클릭 이벤트
    document.getElementById('prev-btn').addEventListener('click', () => {
      currentIndex = (currentIndex - 1 + totalItems) % totalItems;
      updateDisplay();
    });

    // 다음 버튼 클릭 이벤트
    document.getElementById('next-btn').addEventListener('click', () => {
      currentIndex = (currentIndex + 1) % totalItems;
      updateDisplay();
    });

    // 이스터에그 플레이어 버튼 클릭 이벤트 (노말, 레어, 스페셜 음성 재생)
    eggPlayer.querySelectorAll('button').forEach(btn => {
      btn.addEventListener('click', () => {
        const type = btn.getAttribute('data-type');
        playEasterEggAudio(type);
      });
    });

    // 미니 플레이어 컨트롤
    pauseBtn.addEventListener('click', () => {
      if (!audioPlayer) return;
      if (audioPlayer.paused) {
        audioPlayer.play();
        pauseBtn.textContent = '⏸️';
      } else {
        audioPlayer.pause();
        pauseBtn.textContent = '▶️';
      }
    });

    closeBtn.addEventListener('click', () => {
      if (audioPlayer) {
        audioPlayer.pause();
        audioPlayer = null;
      }
      miniPlayer.style.display = 'none';
      if (progressInterval) clearInterval(progressInterval);
    });

    progressBar.addEventListener('input', () => {
      if (audioPlayer && audioPlayer.duration) {
        audioPlayer.currentTime = (progressBar.value / 100) * audioPlayer.duration;
      }
    });

    volumeBar.addEventListener('input', () => {
      if (audioPlayer) {
        audioPlayer.volume = volumeBar.value;
      }
    });

    // 초기 세션에 저장된 클릭 카운트 복원 (20번 슬라이드에서만)
    if (sessionStorage.getItem('eggClickCount')) {
      eggClickCount = parseInt(sessionStorage.getItem('eggClickCount'), 10) || 0;
    }

    // 초기 화면 표시
    updateDisplay();
  </script>
</body>
</html>
